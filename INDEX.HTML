<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactive Form Validation — Project</title>
  <style>
    :root{--bg:#f6f8fb;--card:#ffffff;--accent:#2563eb;--danger:#ef4444;--muted:#6b7280}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial; margin:24px; background:linear-gradient(180deg,#f8fbff, var(--bg)); color:#0f172a}
    .card{max-width:820px;margin:0 auto;padding:22px;border-radius:12px;background:var(--card);box-shadow:0 6px 24px rgba(16,24,40,0.06)}
    h1{font-size:20px;margin:0 0 10px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    form{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .full{grid-column:1/-1}
    label{display:block;font-size:13px;margin-bottom:6px}
    input[type=text],input[type=email],input[type=password],select,input[type=tel],input[type=date]{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ef;font-size:14px}
    .row{display:flex;gap:10px}
    .help{font-size:12px;color:var(--muted);margin-top:6px}
    .error{color:var(--danger);font-size:13px;margin-top:6px}
    .valid{color:green;font-size:13px;margin-top:6px}
    .meter{height:8px;border-radius:6px;background:#e6e9ef;overflow:hidden;margin-top:6px}
    .meter > span{display:block;height:100%;width:0%;transition:width 200ms linear}
    .actions{display:flex;gap:10px;align-items:center;margin-top:10px}
    button{background:var(--accent);color:white;padding:10px 14px;border-radius:10px;border:0;cursor:pointer}
    button.secondary{background:#e6eefc;color:var(--accent)}
    .summary{border:1px dashed #e6eefc;padding:10px;border-radius:8px;font-size:13px;background:#fbfdff}
    /* responsive */
    @media (max-width:720px){form{grid-template-columns:1fr} .full{grid-column:auto}}
  </style>
</head>
<body>
  <div class="card" role="region" aria-labelledby="title">
    <h1 id="title">Interactive Form Validation — Demo</h1>
    <p class="lead">A single-file project with real-time validation, accessibility announcements, password strength, and friendly error messages.</p>

    <form id="signup" novalidate>
      <div class="full">
        <label for="fullname">Full name</label>
        <input id="fullname" name="fullname" type="text" placeholder="e.g. Priya Raman" autocomplete="name" required />
        <div id="fullname-msg" class="help" aria-live="polite"></div>
      </div>

      <div>
        <label for="email">Email</label>
        <input id="email" name="email" type="email" placeholder="you@example.com" autocomplete="email" required />
        <div id="email-msg" class="help" aria-live="polite"></div>
      </div>

      <div>
        <label for="phone">Phone</label>
        <input id="phone" name="phone" type="tel" placeholder="+91 98765 43210" autocomplete="tel" />
        <div id="phone-msg" class="help" aria-live="polite"></div>
      </div>

      <div>
        <label for="password">Password</label>
        <input id="password" name="password" type="password" autocomplete="new-password" required />
        <div class="meter" aria-hidden="true"><span id="pw-meter"></span></div>
        <div id="password-msg" class="help" aria-live="polite"></div>
      </div>

      <div>
        <label for="confirm">Confirm password</label>
        <input id="confirm" name="confirm" type="password" autocomplete="new-password" required />
        <div id="confirm-msg" class="help" aria-live="polite"></div>
      </div>

      <div>
        <label for="dob">Date of birth</label>
        <input id="dob" name="dob" type="date" />
        <div id="dob-msg" class="help" aria-live="polite"></div>
      </div>

      <div>
        <label for="country">Country</label>
        <select id="country" name="country">
          <option value="">Choose country...</option>
          <option>India</option>
          <option>United States</option>
          <option>United Kingdom</option>
          <option>Sri Lanka</option>
          <option>Other</option>
        </select>
        <div id="country-msg" class="help" aria-live="polite"></div>
      </div>

      <div class="full">
        <label><input id="terms" name="terms" type="checkbox" /> I agree to the terms & conditions</label>
        <div id="terms-msg" class="help" aria-live="polite"></div>
      </div>

      <div class="full actions">
        <button id="submit">Create account</button>
        <button type="button" class="secondary" id="reset">Reset</button>
        <div style="margin-left:auto" id="form-status" aria-live="polite"></div>
      </div>

      <div class="full" id="result" style="display:none">
        <h3>Submission summary</h3>
        <div class="summary" id="summary"></div>
      </div>
    </form>
  </div>

  <script>
    // Small utility helpers
    const $ = (sel) => document.querySelector(sel);
    const debounce = (fn, ms=250) => {let t; return (...a)=>{clearTimeout(t); t=setTimeout(()=>fn(...a), ms)}};

    // Elements
    const form = $('#signup');
    const fullname = $('#fullname');
    const email = $('#email');
    const phone = $('#phone');
    const password = $('#password');
    const confirm = $('#confirm');
    const dob = $('#dob');
    const country = $('#country');
    const terms = $('#terms');
    const pwMeter = $('#pw-meter');
    const formStatus = $('#form-status');
    const result = $('#result');
    const summary = $('#summary');

    // Validation rules
    const validators = {
      fullname: (v) => {
        if (!v) return {ok:false, msg:'Name is required.'};
        if (v.length < 3) return {ok:false, msg:'Use at least 3 characters.'};
        if (!/^([\p{L} .'-]{2,})$/u.test(v)) return {ok:false, msg:'Use only letters and typical name characters.'};
        return {ok:true, msg:'Looks good.'};
      },
      email: (v) => {
        if (!v) return {ok:false, msg:'Email is required.'};
        // simple, robust email regex (not perfect, practical)
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;
        return re.test(v) ? {ok:true, msg:'Valid email.'} : {ok:false, msg:'Enter a valid email address.'};
      },
      phone: (v) => {
        if (!v) return {ok:true, msg:'Optional field.'};
        // allow +, spaces, digits, 7-15 digits
        const digits = v.replace(/\D/g,'');
        if (digits.length < 7 || digits.length > 15) return {ok:false,msg:'Enter a valid phone number (7–15 digits).'};
        return {ok:true,msg:'Phone looks okay.'};
      },
      password: (v) => {
        if (!v) return {ok:false,msg:'Password is required.'};
        const checks = [v.length >= 8, /[A-Z]/.test(v), /[a-z]/.test(v), /[0-9]/.test(v), /[^A-Za-z0-9]/.test(v)];
        const passed = checks.filter(Boolean).length;
        if (v.length < 8) return {ok:false, msg:'Use 8 or more characters.'};
        if (passed < 3) return {ok:false, msg:'Use a stronger password (mix letters, numbers, symbols).'};
        return {ok:true, msg:'Strong password.'};
      },
      confirm: (v) => {
        if (!v) return {ok:false, msg:'Please confirm password.'};
        return v === password.value ? {ok:true, msg:'Passwords match.'} : {ok:false, msg:'Passwords do not match.'};
      },
      dob: (v) => {
        if (!v) return {ok:true, msg:'Optional.'};
        const then = new Date(v);
        const age = (()=>{const diff = Date.now() - then.getTime(); return Math.floor(diff / (1000*60*60*24*365.25));})();
        if (age < 0) return {ok:false,msg:'That date is in the future.'};
        if (age < 13) return {ok:false,msg:'You must be at least 13 years old.'};
        return {ok:true,msg:`Age: ${age} years.`};
      },
      country: (v) => ({ok: v?true:false, msg: v? 'Country selected.':'Choose a country.'}),
      terms: (v) => v ? {ok:true,msg:'Thanks for accepting terms.'} : {ok:false,msg:'You must accept terms.'}
    };

    // UI update function for a field
    function showMessage(field, {ok, msg}){
      const el = document.getElementById(field + '-msg');
      el.textContent = msg;
      el.className = ok ? 'valid' : 'error';
      // set aria-invalid on related input
      const input = document.getElementById(field);
      if (input) input.setAttribute('aria-invalid', ok? 'false':'true');
    }

    // Password strength visual
    function updatePwMeter(v){
      const len = v.length;
      let percent = 0;
      if (len === 0) percent = 0;
      else if (len < 8) percent = 20;
      else {
        let score = 0;
        if (/[a-z]/.test(v)) score++;
        if (/[A-Z]/.test(v)) score++;
        if (/[0-9]/.test(v)) score++;
        if (/[^A-Za-z0-9]/.test(v)) score++;
        percent = 40 + score * 15; // between 55 and 100
      }
      percent = Math.min(100, percent);
      pwMeter.style.width = percent + '%';
      // change color via inline style
      if (percent < 40) pwMeter.style.background = '#ef4444';
      else if (percent < 70) pwMeter.style.background = '#f59e0b';
      else pwMeter.style.background = '#10b981';
    }

    // Validate a single field name
    function validateField(name){
      const value = (document.getElementById(name).type === 'checkbox') ? document.getElementById(name).checked : document.getElementById(name).value.trim();
      const res = validators[name](value);
      showMessage(name, res);
      return res.ok;
    }

    // Attach event listeners (debounced for typing fields)
    const liveValidate = debounce((ev) => {
      const id = ev.target.id;
      if (id === 'password') updatePwMeter(ev.target.value);
      validateField(id);
      if (id === 'password' || id === 'confirm') validateField('confirm');
    }, 220);

    ['fullname','email','phone','password','confirm','dob','country'].forEach(id => {
      const el = document.getElementById(id);
      el.addEventListener('input', liveValidate);
      el.addEventListener('blur', (e)=> validateField(id));
    });

    terms.addEventListener('change', ()=> validateField('terms'));

    // On submit
    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      formStatus.textContent = '';
      // Validate all fields
      const fieldNames = ['fullname','email','phone','password','confirm','dob','country','terms'];
      const results = fieldNames.map(n => ({name:n, ok: validateField(n)}));
      const allValid = results.every(r => r.ok);
      if (!allValid){
        formStatus.textContent = 'Please fix the errors above before continuing.';
        formStatus.style.color = 'var(--danger)';
        // Focus first invalid
        const firstBad = results.find(r=>!r.ok);
        if (firstBad) document.getElementById(firstBad.name).focus();
        return;
      }

      // Collect data and show summary (simulate submission)
      const data = {
        fullname: fullname.value.trim(),
        email: email.value.trim(),
        phone: phone.value.trim(),
        dob: dob.value ? dob.value : '—',
        country: country.value || '—'
      };
      summary.innerHTML = Object.entries(data).map(([k,v])=>`<strong>${k}:</strong> ${escapeHtml(v)}`).join('<br>');
      result.style.display = 'block';
      formStatus.textContent = 'Form valid — ready to send.';
      formStatus.style.color = 'green';

      // Here you could actually send data with fetch to your server API.
      // Example (commented):
      // fetch('/api/signup', {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)})

    });

    // Reset button
    $('#reset').addEventListener('click', ()=>{
      form.reset();
      ['fullname-msg','email-msg','phone-msg','password-msg','confirm-msg','dob-msg','country-msg','terms-msg'].forEach(id=>document.getElementById(id).textContent='');
      pwMeter.style.width='0%';
      result.style.display='none';
      formStatus.textContent='';
    });

    // small escape helper for summary
    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, (c)=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

    // Initial lightweight validation for better UX
    validateField('fullname'); validateField('email');
  </script>
</body>
</html>
